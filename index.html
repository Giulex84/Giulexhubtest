<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Giulex Hub – Testnet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>
  <h1>Giulex Hub – Testnet</h1>

  <button onclick="auth()">Authenticate</button>
  <button onclick="pay()">Pay 1 Test-Pi</button>

  <pre id="log">Waiting…</pre>

  <!-- Pi SDK -->
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>

  <script>
    const log = (m) => {
      document.getElementById("log").textContent +=
        "\n" + (typeof m === "string" ? m : JSON.stringify(m, null, 2));
    };

    // INIT SDK — TESTNET
    Pi.init({
      version: "2.0",
      sandbox: true
    });

    let authed = false;

    async function auth() {
      log("Authenticating…");
      try {
        const res = await Pi.authenticate(
          ["username", "payments"],
          (payment) => log("Incomplete payment: " + JSON.stringify(payment))
        );
        authed = true;
        log("AUTH OK");
        log(res);
      } catch (e) {
        log("AUTH ERROR");
        log(e);
      }
    }

    async function pay() {
      log("pay() clicked");
      if (!authed) {
        log("ERROR: authenticate first");
        return;
      }

      try {
        const payment = await Pi.createPayment({
          amount: 1,
          memo: "Giulex Hub Testnet",
          metadata: { test: true }
        });
        log("Payment created");
        log(payment);
      } catch (e) {
        log("PAY ERROR");
        log(e);
      }
    }
  </script>
</body>
</html>
